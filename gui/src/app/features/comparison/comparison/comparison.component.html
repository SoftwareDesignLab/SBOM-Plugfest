<div *ngIf="comparison" class="comparison">
  <div class="header">
    <app-button icon="arrow_back" (click)="path.pop()" *ngIf="path.length > 0" [backgroundColor]="path.length === 1 ? 'var(--gray)' : 'var(--accent)'" />
    <div>
      <span
        class="path"
        *ngFor="let title of path; let i = index"
        (click)="path.splice(i + 1, path.length)"
        >{{ (i === 0 ? getSBOMAlias(title.trim()) : title.trim()) + "/" }}</span
      >
    </div>
  </div>
  <div>
    <div *ngIf="path.length === 0">
      <app-accordion
        *ngFor="let compared of getFilteredCompared()"
        (click)="path.push(compared)"
        [extra]="[getMetadataConflicts(compared).length + getComponentConflictAmount(compared) + ' Conflicts']"
      >
        <div title class="title">
          <span> {{ getSBOMAlias(compared) }}</span>
        </div>
      </app-accordion>
    </div>

    <div *ngIf="path.length === 1">
      <app-accordion
        *ngFor="let conflicts of ['Metadata', 'Components']"
        (click)="path.push(conflicts)"
        [extra]="[(conflicts == 'Metadata' ? getMetadataConflicts(getPathIndex(0)).length : getComponentConflictAmount(getPathIndex(0))) + ' Conflicts']"
      >
        <div title class="title">
          <span> {{ conflicts }}</span>
        </div>
      </app-accordion>
    </div>

    <div *ngIf="path.length === 2 && getPathIndex(1) === 'Metadata'">
      <app-accordion
        [hideToggle]="false"
        *ngFor="let conflict of getMetadataConflicts(getPathIndex(0))"
      >
        <div title class="title">
          <span> {{ conflict.type }}</span>
        </div>
        <div body>
          <span>{{"Target: " + conflict.target}}</span>
          <br/>
          <span>{{"Other: " + conflict.other}}</span>
        </div>
      </app-accordion>
    </div>

    <div *ngIf="path.length === 2 && getPathIndex(1) === 'Components'">
        <app-accordion
        *ngFor="let conflict of ComponentFilter(getComponentConflicts(getPathIndex(0))) | keyvalue"
        (click)="path.push(conflict.key)"
      >
        <div title class="title">
          <span> {{ conflict.key }}</span>
        </div>
      </app-accordion>
    </div>

    <div *ngIf="path.length === 3 && getPathIndex(1) === 'Components'">
      <app-accordion
      [hideToggle]="false"
      *ngFor="let conflict of ComponentFilter(getComponentConflicts(getPathIndex(0)))[path[2]]"
    >
      <div title class="title">
        <span> {{ conflict.type }}</span>
      </div>
      <div body>
        <span>{{"Target: " + conflict.target}}</span>
        <br/>
        <span>{{"Other: " + conflict.other}}</span>
      </div>
    </app-accordion>
  </div>
  </div>
</div>
